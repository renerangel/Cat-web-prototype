<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{templates/templateInitial}">
<head>
	<title>New Order</title>
</head>
<body>
<div layout:fragment="custom-content">
	<div class="container">
		<div class="row">
				<div class="col-md-4">
					<h2>Create new order</h2>
				</div>
		</div>
		<form class="form-horizontal" action="#" th:action="@{/order/save}" th:object="${order}"
			  method="post">
			<div class="form-group">
				<label th:text="#{msg.form.order.number}" class="col-sm-2 control-label"/>
				<div class="col-sm-4">
					<input type="number" th:field="*{orderNumber}" class="form-control" readonly/>
				</div>
			</div>
			<div class="form-group">
				<label th:text="#{msg.form.customer.name}" class="col-sm-2 control-label"/>
				<div class="col-sm-4">
					<input type="text" th:field="*{customerName}"  class="form-control"  readonly/>
				</div>
			</div>
			<div class="form-group">
				<label th:text="#{msg.form.product.search}" class="col-sm-2 control-label"/>
				<div class="col-sm-4">
					<input id="searchValue" type="text" class="form-control"/>
				</div>
				<div class="col-sm-2">
					<a id="search" class="btn btn-primary" href="#" role="button" >
					<span class="glyphicon glyphicon-search"></span>
					</a>
				</div>
			</div>
			<div class="form-group">
				<div class="col-md-8 column" id="allResults" name="allResults" hidden>
					<table id= "searchTable" class="table table-bordered table-hover text-center">
						<tr>
							<th class="text-center">Description</th>
							<th class="text-center">Inventory</th>
							<th class="text-center">Price</th>
							<th></th>
						</tr>
						<tr th:each="product,rowStat : ${productList}">
							<td th:text="${product.description}"></td>
							<td th:text="${product.inventory}"></td>
							<td th:text="'$'+${product.price}"></td>
							<td><button type="submit" name="AddProduct" class="btn btn-info"
										th:value="${product.id}"><span class="glyphicon glyphicon-plus"></span> </button>
							</td>
						</tr>
					</table>
				</div>
			</div>
			<div class="form-group">
				<div class="col-md-10 column">
					<label th:text="#{msg.form.product.added.order}" class="col-sm-3 control-label text-left"/>
					<table class="table table-bordered table-hover" id="tab_logic">
						<thead>
						<div class="form-group">
							<div id="allProducts" class="col-md-10 column">
								<table id= "productsTable" class="table table-bordered table-hover">
									<thead>
									<tr>
										<th class="text-center">
											#
										</th>
										<th class="text-center">
											<label th:text="#{msg.form.product.name}"/>
										</th>
										<th class="text-center">
											<label th:text="#{msg.form.product.quantity}"/>
										</th>
										<th class="text-center">
											<label th:text="#{msg.form.product.unit.price}"/>
										</th>
										<th class="text-center">
											<!-- <button  type="submit" name="addRow" th:text="#{msg.product.row.add}">Add row</button>  -->
										</th>
									</tr>
									</thead>
									<tbody id="productTableBody">
									<tr th:each="prod,rowStat : *{products}">
										<td th:text="${rowStat.count}"></td>
										<!-- <td th:text="${prod.description}"></td> -->
										<input type="hidden" th:field="*{products[__${rowStat.index}__].idProduct}" />

										<td><input type="text" th:field="*{products[__${rowStat.index}__].description}" class="form-control" readonly/></td>
										<td><input type="number" th:field="*{products[__${rowStat.index}__].quantity}" th:id="*{products[__${rowStat.index}__].idProduct}"  class="form-control"/></td>
										<p class="alert alert-danger" th:if="${#fields.hasErrors('products[__${rowStat.index}__].quantity')}" th:errors="*{products[__${rowStat.index}__].quantity}">Please Check the Order</p>
										<td>
											<div class="input-group">
												<span class="input-group-addon">$</span>
												<input type="text" th:field="*{products[__${rowStat.index}__].price}" class="form-control" readonly/>
											</div>
										</td>
										<!--<p class="alert alert-danger" th:if="${#fields.hasErrors('products[__${rowStat.index}__].price')}" th:errors="${#fields.hasErrors('products[__${rowStat.index}__].quantity')}">NOT GOOD</p>-->
										<td><button class="btn btn-danger" type="submit" name="removeRow"
													th:value="${rowStat.index}"><span class="glyphicon glyphicon-remove"></span></button>

										</td>
									</tr>
									</tbody>
								</table>
							</div>
						</div>
						<div class="form-group">
							<label th:text="#{msg.form.order.subtotal}" class="col-sm-7 control-label"/>
							<div class="col-sm-3">
								<div class="input-group">
									<span class="input-group-addon">$</span>
									<input  id="subtotalValue" type="text"
											th:field="*{total}" class="form-control" readonly/>
								</div>
							</div>
						</div>
						<div class="form-group">
							<label th:text="#{msg.form.order.tax}" class="col-sm-7 control-label"/>
							<div class="col-sm-3">
								<div class="input-group">
									<span class="input-group-addon">$</span>
									<input id="taxValue" type="text" class="form-control" readonly/>
								</div>
							</div>
						</div>
						<div class="form-group">
							<label th:text="#{msg.form.order.total}" class="col-sm-7 control-label"/>
							<div class="col-sm-3">
								<div class="input-group">
									<span class="input-group-addon">$</span>
									<input id="totalValue" type="text" class="form-control" readonly/>
									<p class="alert alert-danger" th:if="${#fields.hasErrors('total')}" th:errors="*{total}" ></p>
								</div>
							</div>
						</div>
						<div class="form-group">

							<input id="btnSubmit" class="btn btn-success" type="submit" value="Submit"/>
							<input class="btn btn-danger" type="submit" name="clearForm" value="Cancel"/>

						</div>
						</thead>
					</table>
				</div>
			</div>
		</form>
		<div class="form-group">
			<input id="status" type="hidden" th:value="${orderAdded}" class="col-sm-7 control-label"/>
			<input id="emptyCart" type="hidden" th:value="${emptyCart}" class="col-sm-7 control-label">
		</div>
		<hr>
	</div>
</div>
<footer>
	<p layout:fragment="custom-footer">
	<p>
</footer>

</body>
</html>